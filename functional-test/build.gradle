plugins {
    id 'groovy'
}
apply from: "../gradle/java-version.gradle"
repositories {
    mavenLocal()
    mavenCentral()
}
dependencies {

    testImplementation 'org.spockframework:spock-core:2.0-groovy-3.0'
    testImplementation "org.testcontainers:testcontainers:1.18.3"
    testImplementation "org.testcontainers:spock:1.18.3"
    testImplementation "com.fasterxml.jackson.core:jackson-databind:${jacksonDatabindVersion}"
    testImplementation "com.squareup.okhttp3:okhttp:${okhttpVersion}"
    testImplementation "org.slf4j:slf4j-simple:${slf4jVersion}"
    testImplementation "org.seleniumhq.selenium:selenium-java:${seleniumJavaVersion}"
}

task apiTest(type: Test){
    useJUnitPlatform()
    systemProperty("TEST_RUNDECK_CONTAINER_SERVICE", "rundeck")
    systemProperty('TEST_RUNDECK_IMAGE', "rundeck/rundeck")
    systemProperty('TEST_RUNDECK_URL', "http://localhost:4440")
    systemProperty("composePath", "docker/compose/oss/docker-compose.yml")
    systemProperty('spock.configuration','spock-configs/IncludeAPITestsConfig.groovy')
    description = "Run API tests"
}

task seleniumCoreTest(type: Test){
    useJUnitPlatform()
    systemProperty("TEST_RUNDECK_CONTAINER_SERVICE", "rundeck")
    systemProperty('TEST_RUNDECK_IMAGE', "rundeck/rundeck")
    systemProperty('TEST_RUNDECK_URL', "http://localhost:4440")
    systemProperty("composePath", "docker/compose/oss/docker-compose.yml")
    systemProperty('spock.configuration', 'spock-configs/IncludeSeleniumCoreTestsConfig.groovy')
    description = "Run Rundeck OSS Selenium Tests"
}